<!DOCTYPE html>
<html>

<head>
    <title>Point your arrow</title>
</head>

<body>

    <form id="zoekform" name="zoekform">
        <div>
            <label for="nickname">Nickname: </label>
            <input type="text" name="nickname" id="nickname" />
        </div>
        <div>
            <label for="beroep">Beroep: </label>
            <input type="text" name="beroep" id="beroep" />
        </div>
        <div>
            <label for="geslacht">Welk geslacht? *</label>
            <select name="geslacht" id="geslacht">
                <option value="" selected>------ Kies -------</option>
                <option>m</option>
                <option>v</option>
                <option>x</option>
            </select>
        </div>
        <div>
            <label for="haarkleur">Haarkleur: *</label>
            <input type="text" name="haarkleur" id="haarkleur" />
        </div>
        <div>
            <label for="oogkleur">Oogkleur: *</label>
            <input type="text" name="oogkleur" id="oogkleur" />
        </div>
        <div>
            <label for="grootte">Grootte: </label>
            <input type="text" name="grootte" id="grootte" />
        </div>
        <div>
            <label for="gewicht">Gewicht: </label>
            <input type="text" name="gewicht" id="gewicht" />
        </div>
        <button type="button" id="zoek">ZOEK</button>

        <ul id="lijst">

        </ul>

    </form>

    <script>
        var rooturl = "https://scrumserver.tenobe.org/scrum/api";

        function changeURL(sNewRoot) {
            rooturl = sNewRoot;
            console.log('root set to : ' + rooturl)
        }

        window.onload = function () {
            document.getElementById('zoek').addEventListener('click', function (e) {
                var url = rooturl + '/profiel/search.php?';
                //VALIDATIE GEGEVENS
                if (validatie() == true) {
                    if (document.getElementById('nickname').value != "") {
                        url += 'nickname=' + document.getElementById('nickname').value + '&';
                    }
                    if (document.getElementById('beroep').value != "") {
                        url += 'beroep=' + document.getElementById('beroep').value + '&';
                    }
                    if (document.getElementById('geslacht').value != "") {
                        url += 'sexe=' + document.getElementById('geslacht').value + '&';
                    }
                    if (document.getElementById('haarkleur').value != "") {
                        url += 'haarkleur=' + document.getElementById('haarkleur').value;
                    }
                    fetch(url)
                        .then(function (resp) { return resp.json(); })
                        .then(function (data) {
                            let test = [data]
                            let lijst = document.getElementById("lijst");
                            console.log(data);
                            for (let i = 0; i < data.length; i++) {
                                test[i] = data[i]
                                //console.log(test[i].voornaam + test[i].familienaam)
                                let item = document.createElement('li');
                                item.innerHTML = test[i].voornaam + ' ' + test[i].familienaam
                                lijst.appendChild(item);
                            }
                        })
                        .catch(function (error) { console.log(error); });

                    //resetten formulier
                    var eLijst = document.getElementById('zoekform');
                    eLijst.reset();

                }; //einde IF    
            }); // einde click

        } // einde window onload

        function validatie() {


            if ((isNaN(document.zoekform.grootte.value) || document.zoekform.grootte.value <= 0 || document.zoekform.grootte.value >= 250) && document.zoekform.grootte.value != "") {
                alert('Geef een geldige grootte');
                return false
            };
            if ((isNaN(document.zoekform.gewicht.value) || document.zoekform.gewicht.value <= 0 || document.zoekform.gewicht.value >= 600) && document.zoekform.gewicht.value != "") {
                alert('Geef een geldig gewicht');
                return false
            };

            return true;
        }; //einde validatiefunctie

        /*if (document.zoekform.haarkleur.value == '') {
    alert('Kies een haarkleur');
    return false
};
if (document.zoekform.oogkleur.value == '') {
    alert('Kies een oogkleur');
    return false
};

if (document.zoekform.geslacht.value == '') {
    alert('Kies een geslacht');
    return false
};*/


    </script>




</body>

</html>